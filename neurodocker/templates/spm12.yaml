# Instructions to install SPM.
#
# Website: http://www.fil.ion.ucl.ac.uk/spm/
# Documentation: http://www.fil.ion.ucl.ac.uk/spm/doc/

generic:
  binaries:
    dependencies: null
    env:
      FORCE_SPMMCR: 1
    instructions: |
      echo "Downloading standalone SPM ..."
      curl {{ spm12.curl_opts }} -o /tmp/spm12.zip {{ spm12.binaries_url }}
      unzip -q spm12.zip -d /tmp
      mkdir -p {{ spm12.install_path }}
      mv /tmp/spm*/* {{ spm12.install_path }}/
      chmod -R 777 {{ spm12.install_path }}
      rm -rf /tmp/spm*
      {{ spm12.install_path }}/run_spm12.sh {{ spm12.mcr_path }} quit
      sed -i '$iexport SPMMCRCMD=\"{{ spm12.install_path }}/run_spm12.sh {{ spm12.mcr_path }} script\"' $ND_ENTRYPOINT
